<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update</title>
    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        function getData(){
            return fetch(`/getProductById?id=${id}`)
                .then(response => response.json())
                .then(json=> {
                    renderData(json);
                })
        }
        function renderData(data){
            console.log(data)
            let tenSanPham= document.getElementById("ten");
            let giaSanPham= document.getElementById("donGia");
            tenSanPham.value= data.tenSanPham;
            giaSanPham.value= data.donGia;
        }
        function updateProduct(){
            const tenSanPham= document.getElementById("ten").value
            const loai= document.getElementById("loai").value
            let loaiSanPham=-1;
            if(loai=="quanAo")
                loaiSanPham=1;
            if(loai=="hangGiaDung")
                loaiSanPham=2;
            if(loai=="trangSuc")
                loaiSanPham=3;
            const giaSanPham= document.getElementById("donGia").value
            console.log(tenSanPham, loaiSanPham, giaSanPham)
            //Post data
            fetch(`updateProduct?id=${id}&name=${tenSanPham}&loaiId=${loaiSanPham}&donGia=${giaSanPham}`, {
                method: 'POST',
                headers: {
                    'Content-type': 'application/json'
                }
            })
                .then(response => {
                    if(response.ok)
                        alert("Cap nhat thanh cong!")
                })
        }

        getData();
    </script>
</head>
<body>
<h1>Them san pham</h1>
<div>
    <div>
        <label>Cap nhat san pham</label>
        <input type="text" placeholder="enter ten" id="ten">
    </div>
    <div>
        <select id="loai" >
            <option value="quanAo">Quan ao</option>
            <option value="hangGiaDung">Hang gia dung</option>
            <option value="trangSuc">Trang suc</option>
        </select>
    </div>
    <div>
        <label>Don gia</label>
        <input type="text" placeholder="enter don gia" id="donGia">
    </div>
    <div>
        <button type="button" onclick=updateProduct() >Update</button>
        <a href="/quanLySanPham">Back</a>
    </div>
</div>
</body>
</html>